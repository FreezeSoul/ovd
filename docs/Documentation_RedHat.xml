<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" 
	  "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">
<article>
  <articleinfo>
    <title>Installation documentation for Ulteo Open Virtual Desktop on Red Hat systems</title>
    <graphic fileref="img/ovd.png" align="center"/>

    <copyright>
      <year>2008</year>
      <holder>Ulteo SAS - http://www.ulteo.com</holder>
    </copyright>
  </articleinfo>

  <section>
    <title>Prerequisites</title>
    <para>
      At least two machines are needed to install Ulteo Open Virtual Desktop:
    </para>
    <itemizedlist>
      <listitem>
	<para>a LAMP (Linux Apache MySQL PHP) server for the Session Manager (here we are using <emphasis>sm.ulteo.com</emphasis> for that server, but you need to set your own domain name)</para>
      </listitem>
      <listitem>
	<para>another server for the Application Server. (here we are using <emphasis>cm.ulteo.com</emphasis> for that server, but you need to set it according to your own domain name)</para>
      </listitem>
    </itemizedlist>
    <para>
      Both servers needs to be installed with Red Hat RHEL 5.2 32-bit, Fedora Core 9 or CentOS 5.2.
      All operations needs to be done as <emphasis>superuser</emphasis> (root).
    </para>


   <section>
      <title>Installation of MySQL</title>
      <para>
	If you don't have any available MySQL database, you have to install MySQL on your Session Manager.
      </para>

      <itemizedlist>
	<listitem>
	  <para>
	    Install the <emphasis>mysql-server</emphasis> package:
	  </para>
          <screen>
            <![CDATA[
# yum install mysql mysql-server]]>
          </screen>
        </listitem>

	<listitem>
	  <para>
	    To start automatically MySQL when the system boots up
	  </para>
	  <screen>
	    <![CDATA[
# chkconfig --levels 235 mysqld on]]>
	  </screen>
	</listitem>

	<listitem>
	  <para>
	    Start the service
	  </para>
	  <screen>
	    <![CDATA[
# service mysqld start]]>
	  </screen>
	</listitem>

	<listitem>
	  <para>
	    Define the root mysql password
	  </para>
	  <screen>
	    <![CDATA[
# mysqladmin -u root password 'mysql_root_password']]>
	  </screen>
	</listitem>


        <listitem>
          <para>Now log in mysql and create a database and an user who will have
          rights on the databse:</para>

	      <screen>
		<![CDATA[
# mysql -u root -p
Enter password:
mysql> create database sm;
 Query OK, 1 row affected (0.02 sec)
mysql> exit]]>
	      </screen>

        </listitem>
      </itemizedlist>
      <beginpage />
    </section>
  </section>

  <section>
    <title>Session Manager (sm.ulteo.com)</title>
    <para>
      The Session Manager is the main server for your <emphasis>Ulteo Open Virtual Desktop infrastructure</emphasis>.
      It will manage all your application servers through an administration web interface.
    </para>

  <section>
    <title>Installation</title>

    <itemizedlist>
     <listitem>
	<para>
	  Download the Ulteo Open Virtual Desktop rpm packages from <ulink url="http://firex.ulteo.com/~gauvain/oxylane/" />, (at this time <emphasis>ovd-session-manager-1.0~beta1.2-1.noarch.rpm</emphasis>)
	</para>
     </listitem>

     <listitem>
	<para>Intall the <emphasis>ovd-session-manager</emphasis> package:</para>
        <screen>
	  <![CDATA[
# yum install --nogpgcheck ovd-session-manager-1.0~beta1.2.1.noarch.rpm]]>
	</screen>
      </listitem>

     <listitem>
       <para>Launch the configuration tool</para>
       <screen>
	 <![CDATA[
# sm-config
Admin login: admin
Password: 
Retype password: 
Chroot download url [http://www.ulteo.com/main/downloads/ulteo-ovd.php]: http://firex.ulteo.com/~gauvain/oxylane/chroot-20091501.tar.gz
Chroot destination [/usr/share/ulteo/sessionmanager/base.tar.gz]: 

Options:
* chroot download:  yes
* chroot URL:       http://firex.ulteo.com/~gauvain/oxylane/chroot-20091501.tar.gz
* chroot directory: /usr/share/ulteo/sessionmanager/base.tar.gz
* apache group:     apache
* apache dir:       /etc/httpd/conf.d

Is this correct? [Y/n] ]]>
       </screen>
     </listitem>


     <listitem>
       <para>Configure and start apache service</para>
       <screen>
	 <![CDATA[
# chkconfig httpd on
# service httpd restart]]>
       </screen>
     </listitem>

    </itemizedlist>

    <para>
      The server is now installed but not configured yet. You have to open <ulink url="http://sm.ulteo.com/sessionmanager" /> with a web browser. It should display this page:
    </para>
    <para>
      <inlinemediaobject>
	<imageobject>
	  <imagedata fileref="img/sm_www_service_not_available.png"/>
	</imageobject>
	<textobject>
	  <phrase>Session Manager into a web browser</phrase>
	</textobject>
      </inlinemediaobject>
    </para>
  </section>

   <section>
      <title>Configuration</title>

      <para>
	The first step is to go to <ulink url="http://sm.ulteo.com/sessionmanager/admin" /> and autenticate yourself with the login and password you provided during the installation.
      </para>
      <para>
	<inlinemediaobject>
	  <imageobject>
	    <imagedata fileref="img/sm_www_admin_login.png"/>
	  </imageobject>
	  <textobject>
	    <phrase>Session Manager admin login</phrase>
	  </textobject>
	</inlinemediaobject>
      </para>

      <para>
	<inlinemediaobject>
	  <imageobject>
	    <imagedata fileref="img/sm_install_admin_config_init.png"/>
	  </imageobject>
	  <textobject>
	    <phrase>Session Manager admin init configuration</phrase>
	  </textobject>
	</inlinemediaobject>
      </para>

      <itemizedlist>
	<listitem>
	  <para>
	    <emphasis role="strong">Authorized network domain:</emphasis> replace by the domain name of your network.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Disable reverse FQDN checking:</emphasis>
	    if you don't have a valid domain name service for your machines, you have to select <emphasis>yes</emphasis> but it may be a security risk.
	    Ideally, you should configure your DNS server correclty and keep this option to <emphasis>No</emphasis>.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Advanced settings options:</emphasis>
	    you can allow the user to force some options. For instance, to force the application server to use, or to enable the debug mode.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis role="strong">MySQL configuration:</emphasis>
	    you have to provide some MySQL configuration data for the system to work properly.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis role="strong">Module ApplicationDB:</emphasis>
	    select MySQL. The "fake" module is a hard-coded application list used when there are problems with the automatic application detection.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Module UserDB:</emphasis>
	    there are several ways to plug users into the system:
	  </para>
	  <itemizedlist>
	    <listitem>
	      <para>
		<emphasis>fake</emphasis>: it's a hard-coded user list to quickly test the system. 
		For instance, you can begin with this module if you have never tested it earlier.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<emphasis>LDAP</emphasis>: if you are using LDAP to manage your users, you can select this module and configure how to match your users with the directory (LDAP tree, DN ...).
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<emphasis>Active Directory</emphasis>: if you want to plug the system into your Active Directory environment, select this module and provide you AD server name and domain.
	      </para>
	    </listitem>
	  </itemizedlist>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Plugin configuration FS</emphasis>:
	    You can choose how to manage the home directory for your users:
	  </para>
	  <itemizedlist>
	    <listitem>
	      <para>
		if you select Active Directory as UserDB, 
		you certainly want to use the Windows share directory from your CIFS servers. In this case, select the CIFS module.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		if your are using NFS servers for your users home directories and you know how to setup the matching between the local DB and your LDAP configuration, then you can select NFS.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
	        if you don't have any network filesystem available, select local. It will store files on the application server. (not recommended)
	      </para>
	    </listitem>
	  </itemizedlist>
	</listitem>
      </itemizedlist>

      <para>
	The session manager has no application server plugged yet.
	You now have to install one or more application servers.
      </para>
      <beginpage />
    </section>
  </section>

  <section>
    <title>Application Server installation (cm.ulteo.com)</title>

    <itemizedlist>
     <listitem>
	<para>
	  Download the Ulteo Open Virtual Desktop rpm packages from <ulink url="http://firex.ulteo.com/~gauvain/oxylane/" />,  (at this time <emphasis>ovd-application-server-1.0~beta1.2.1.noarch.rpm</emphasis>)
	</para>
     </listitem>

     <listitem>
	<para>Intall the <emphasis>ovd-application-server</emphasis> package:</para>
        <screen>
	  <![CDATA[
# yum install --nogpgcheck ovd-application-server-1.0~beta1.2.1.noarch.rpm]]>
	</screen>
     </listitem>

     <listitem>
       <para>Launch the configuration tool</para>
       <screen>
	 <![CDATA[
# as-chroot-install 
Full Qualified Domain Name [cm.ulteo.com]: cm.ulteo.com
Session Manager URL: http://sm.ulteo.com/sessionmanager
Chroot installation path: /opt/ulteo

Options:
* FQDN: cm.ulteo.com
* SM URL: http://sm.ulteo.com/sessionmanager
* chroot path: /opt/ulteo
* chroot download: yes
* apache group: apache
* apache dir: /etc/httpd/conf.d

Is this correct? [Y/n] ]]>
       </screen>
     </listitem>

     <listitem>
       <para>Configure and start apache service</para>
       <screen>
	 <![CDATA[
# chkconfig httpd on
# service httpd restart]]>
       </screen>
     </listitem>

     <listitem>
       <para>Configure and start Ulteo service</para>
       <screen>
	 <![CDATA[
# chkconfig ulteo-ovd on
# service ulteo-ovd restart]]>
       </screen>
     </listitem>

    </itemizedlist>

    <beginpage />
  </section>


  <section>
    <title>Register the server and perform a "Publication"</title>
    <para>
      An Application server has been installed and is now ready. First, we have to register it, and switch it from "maintenance" to "production" mode.

    <itemizedlist>
      <listitem>
	<para>
	  You should see your server as "unregistered" in the server page:
	</para>

	<screenshot>
	  <screeninfo>Session Manager - server page</screeninfo>
	  <graphic fileref="img/sm_admin_server_unregistered.png"></graphic>
	</screenshot>
      </listitem>

      <listitem>
	<para>
	  If you want to use this server on your network, 
	  you have to click on <emphasis>register</emphasis>
	  to accept the server in your environment and switch it to maintenance mode.
	</para>
      </listitem>
      <listitem>
	<para>Now, click on <emphasis>Switch to production</emphasis> to switch it to Production mode.</para>
      </listitem>
    </itemizedlist>
    </para>

    <para>
      The next step is to perform a "publication" to authorize a usergroup to use applications.
    <screenshot>
      <screeninfo>Session manager - publication page</screeninfo>
      <graphic fileref="img/sm_admin_publication.png"></graphic>
    </screenshot>

      Go to the Publications page, select and follow the <emphasis>wizard</emphasis> steps.
    </para>

    <beginpage />
  </section>

  
  <section>
    <title>Launch a session</title>

    <itemizedlist>
      <listitem>
	<para>
	  Back to <ulink url="http://sm.ulteo.com/sessionmanager/" /> with your browser, you should see a login page:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
	      <imagedata fileref="img/sm_login.png"/>
            </imageobject>
            <textobject>
	      <phrase>Session Manager login</phrase>
            </textobject>
	  </inlinemediaobject>
	</para>

	<beginpage />
      </listitem>
 
      <listitem>
	<para>
	  Once logged in, the session is launching:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
	      <imagedata fileref="img/cm_session_launching.png"/>
            </imageobject>
            <textobject>
	      <phrase>Session launching</phrase>
            </textobject>
	  </inlinemediaobject>
	</para>

	<beginpage />
      </listitem>

      <listitem>
	<para>
	  The session is launched and is ready to use:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
	      <imagedata fileref="img/cm_session.png"/>
            </imageobject>
            <textobject>
	      <phrase>Session launched</phrase>
            </textobject>
	  </inlinemediaobject>
	</para>
      </listitem>
    </itemizedlist> 
  </section>
</article>

<?xml version="1.0" ?>
<!DOCTYPE article PUBLIC "-//Norman Walsh//DTD DocBk XML V4.0//EN"
          "http://www.oasis-open.org/docbook/xml/4.0/docbookx.dtd">
<article>
  <articleinfo>
    <title>RSBAC setup on a CM server</title>
  </articleinfo>

  <para>
    We assume that you have a working Ulteo SBC system (see <ulink
    url="UseCase.html">the installation documentation</ulink>).
  </para>

  <section>
      <title>A few words about RSBAC</title>
      <para>
        RSBAC is a kernel patch adding lots of security features on a Linux
        system. On an Ulteo CM server, a <literal>security</literal> user is created,
        it's password being the root one (you most likely want to modify it, or
        use ssh keys). This user has very limited rights on the system itself
        but can be used to modify the RSBAC configuration.
      </para>
      <para>
        There are 2 RSBAC modes, the <emphasis>secure</emphasis> and the
        <emphasis>soft</emphasis> modes. The soft mode is the one we will use
        first, to apply the RSBAC configuration. Then we'll switch to the secure
        mode.
      </para>
  </section>

  <section>
    <title>Setting up RSBAC</title>
    <itemizedlist>
        <listitem>
          <para>Install an RSBAC kernel:</para>
          <screen><![CDATA[
# apt-cache search linux-image rsbac
linux-image-2.6.26.3-rsbac-norc-ulteo-1 - Linux kernel binary image for version 2.6.26.3-rsbac-norc-ulteo-1
# apt-get install linux-image-2.6.26.3-rsbac-norc-ulteo-1]]>
          </screen>
        </listitem>
        <listitem>
          <para>Install ulteo-od tools:</para>
          <screen><![CDATA[
# apt-get install ulteo-od-utils]]>
          </screen>
        </listitem>
        <listitem>
          <para>Generate a grub config to boot the kernel in soft mode, and reboot:</para>
          <screen><![CDATA[
# cp /boot/grub/menu.lst{,bak}
# gen-rsbac-menu soft 2.6.26.3-rsbac-norc-ulteo-1 > /boot/grub/menu.lst
# reboot]]>
          </screen>
        </listitem>
        <listitem>
          <para>Install the RSBAC support package for ulteo od:</para>
          <screen><![CDATA[
# apt-get install ulteo-od-rsbac]]>
          </screen>
          <para>The Ulteo RSBAC configuration will be automatically
          applied.</para>
        </listitem>
        <listitem>
          <para>Prepare the reboot in secure mode:</para>
          <screen><![CDATA[
# gen-rsbac-menu secure 2.6.26.3-rsbac-norc-ulteo-1 > /boot/grub/menu.lst
# reboot]]>
          </screen>
        </listitem>
    </itemizedlist>
  </section>

  <section>
    <title>What brings this configuration of RSBAC</title>
    <itemizedlist>
      <listitem><para>users can't see other users' process</para></listitem>
      <listitem><para>each user has its own <literal>/tmp</literal>
      dir</para></listitem>
      <listitem><para>ssh is only usable for root and security</para></listitem>
      <listitem><para>sensible process run in a jail with restricted rights
      (apache, log daemons, user session)</para></listitem>
      <listitem><para>setuid and setgid are not possible, which means that even
      root can't login as an user</para></listitem>
      <listitem><para>root can't browse the users dirs, so if someone gain root
      privileges, there's not much he can do</para></listitem>
    </itemizedlist>
  </section>

  <section>
    <title>Administration</title>
      <itemizedlist>
        <listitem><para>you can switch to softmode by running as
        <literal>security</literal> user:</para>
          <screen>$ switch_module SOFTMODE 1</screen>
        </listitem>
        <listitem><para>after package installations you might need to re-apply
        the policy with:</para>
        <screen>$ apply_policy</screen>
        </listitem>
      </itemizedlist>
  </section>
</article>


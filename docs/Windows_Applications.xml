<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" 
"/usr/share/xml/docbook/schema/dtd/4.5/docbookx.dtd">

<article>
  <articleinfo>
    <title>Ulteo Open Virtual Desktop - <trademark>Windows</trademark> Applications</title>
    <graphic fileref="img/ovd.png" align="center"/>
    <!--
    <authorgroup>
      <author>
	<firstname>Julien</firstname>
	<surname>Langlois</surname>
	<affiliation>
	  <jobtitle>Ulteo developer</jobtitle>
	  <address><email>julien@ulteo.com</email></address>
	</affiliation>
      </author>
    </authorgroup>
    -->

    <copyright>
      <year>2009</year>
      <holder>Ulteo SAS</holder>
    </copyright>
  </articleinfo>

  <para>
    This documentation describe how to use <trademark>Windows</trademark> applications on an
    existing and running <emphasis>Ulteo Open Virtual
    Desktop</emphasis>.
  </para>
  <para>
    This documention <emphasis role="strong">does not
    describe</emphasis> the Open Virtual Desktop. For this, please see
    the <emphasis role="strong">Installation
    documentations</emphasis>.
  </para>


  <section>
    <title>Prerequisites</title>
    <para>
      To use <trademark>Windows</trademark> applications, you need to plug your Session
      Manager on an <trademark
      class="registered">Microsoft</trademark> Domain Controler
      (Active Directory).
    </para>

    <para>
      You also need to have at least one <emphasis
      role="strong"><trademark
      class="registered">Microsoft</trademark> <trademark><trademark>Windows</trademark>
      Server 2003</trademark></emphasis> system with <emphasis
      role="strong"><trademark>Terminal services</trademark></emphasis> installed and
      configured.
    </para>

    <para>
      The <trademark>Windows</trademark> Server machines have to be plug in the same domain
      controler as the Session Manager. To plug a Session Manager to a
      <trademark class="registered">Microsoft Active</trademark>
      Directory, please refer to <emphasis>Administration
      Console</emphasis> documentation.
    </para>
  </section>

  <section>
    <title>Installation of the <trademark>Windows</trademark> agent</title>

    <para>
      Download the Ulteo Open Virtual Desktop <trademark>Windows</trademark> agent setup from
      <ulink url="http://www.ulteo.com">this place at
      www.ulteo.com</ulink> on your <trademark>Windows</trademark> machine and execute it.
    </para>

    <screenshot>
      <screeninfo>Session Manager - server page</screeninfo>
      <graphic fileref="img/aps_win_install_1.png"></graphic>
    </screenshot>

    <para>
      In the configuration frame, you have to set the <trademark>Windows</trademark> server
      name. To get the <trademark>Windows</trademark> FQDN, go to <emphasis>Start</emphasis>,
      then right-click on <emphasis>My Computer</emphasis>:
      <emphasis>Properties</emphasis>.
      In the <emphasis>Computer Name</emphasis> tab, the FQDN is
      display as <emphasis role="strong">Full computer name</emphasis>.
    </para>

    <screenshot>
      <screeninfo>Session Manager - server page</screeninfo>
      <graphic fileref="img/aps_win_install_config.png"></graphic>
    </screenshot>

    <para>
      Finish the installation. The <trademark>Windows</trademark> agent should be configured
      and running.
    </para>

    <simplesect>
      <title>Session Manager side</title>
      <para>
	Your <trademark>Windows</trademark> server should appear in the
	<emphasis>Unregistered servers</emphasis>.
      </para>

      <screenshot>
	<screeninfo>Session Manager - server page</screeninfo>
	<graphic fileref="img/sm_admin_server_unregistered_win.png"></graphic>
      </screenshot>

      <para>
	If your server does not appear in the list, you might have
	a DNS configuration issue, or ths <trademark>Windows</trademark> agent have a
	bug. Refert to <xref linkend="s_issue"/>.
      </para>
    </simplesect>
  </section>

  <section>
    <title>Register the server and publish some application</title>
    <para>
      First, register your <trademark>Windows</trademark> server and switch it from
      "maintenance" to "production" mode.
    </para>

    <para>
      You should be able to list the application from your <trademark>Windows</trademark> server
    </para>

    <screenshot>
      <screeninfo>Session Manager - server page</screeninfo>
      <graphic fileref="img/sm_admin_server_win.png"></graphic>
    </screenshot>

    <para>
      The next step is to add some <trademark>Windows</trademark> applications into an
      applications groups in order to authorized a user group to run
      your <trademark>Windows</trademark> applicaitions.
    </para>

    <para>
      So perform a publication as you did previously did it but by
      select some <trademark>Windows</trademark> applications.  To have a global view of
      which user have access to which applications, you can browse the
      <emphasis role="strong">Summary</emphasis> page from the
      <emphasis>Status</emphasis> menu.
    </para>
  </section>


  <section>
    <title>Lauch a session</title>
    <para>
      If you launch a session, your should access to your <trademark>Windows</trademark> applications.
    </para>

    <screenshot>
      <screeninfo>Session Manager - server page</screeninfo>
      <graphic fileref="img/aps-session-win-appps.png"></graphic>
    </screenshot>

  </section>



  <section id="s_issue">
    <title>Internal System</title>

    <simplesect>
      <title>Consult the <trademark>Windows</trademark> agent log</title>

      <para>
	In a default <trademark>Windows</trademark> installation, the log file is at
	<emphasis>C:\Documents and Settings\All Users\Application
	Data\Ulteo\ovd\main.log</emphasis>.
      </para>

      <para>
	It's also possible to see some debug messages in the <emphasis
	role="strong"><trademark>Windows</trademark> Event Viewer</emphasis> (in Appplication section).
      </para>

      <screenshot>
	<screeninfo><trademark>Windows</trademark> - events</screeninfo>
	<graphic fileref="img/aps_win_event.png"></graphic>
      </screenshot>

    </simplesect>

    <simplesect>
      <title>Automaticaly start the service at boot</title>
      <para>
	At the moment, the <trademark>Windows</trademark> service is not configured to be
	started automaticaly at boot.
      </para>

      <para>
	To set it up, go to <emphasis>Administrative Tools</emphasis>,
	<emphasis>Services</emphasis> and find the <emphasis>Ulteo
	Open Virtual Desktop</emphasis> service.
      </para>

      <screenshot>
	<screeninfo><trademark>Windows</trademark> - services managment</screeninfo>
	<graphic fileref="img/aps_win_services.png"></graphic>
      </screenshot>

      <para>
	Edit the <emphasis>Properties</emphasis> of the services, set
	the <emphasis role="strong">Startup type</emphasis> to
	<emphasis>Automatic</emphasis>, and apply.
      </para>

      <screenshot>
	<screeninfo><trademark>Windows</trademark> - services set to start as boot</screeninfo>
	<graphic fileref="img/aps_win_services_set_boot.png"></graphic>
      </screenshot>
    </simplesect>


  </section>


</article>

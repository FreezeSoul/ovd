<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" 
	  "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">
<article>
  <articleinfo>
    <title>Installation documentation for Ulteo Open Virtual Desktop</title>
    <graphic fileref="img/ovd.png" align="center"/>

    <copyright>
      <year>2008</year>
      <holder>Ulteo SAS - http://www.ulteo.com</holder>
    </copyright>

    <productname>Ulteo Open Virtual Desktop</productname>
    <productnumber>1.0-beta</productnumber>
  </articleinfo>

  <section>
    <title>Prerequisites</title>
    <para>
      At least two machines are needed to install Ulteo Open Virtual Desktop:
    </para>
    <itemizedlist>
      <listitem>
	<para>a LAMP (Linux Apache MySQL PHP) server for the Session Manager. (for the example here we are using <emphasis>sm.ulteo.com</emphasis> but you need to set your own domain name)</para>
      </listitem>
      <listitem>
	<para>another server for the Application Server. (for the example here we use <emphasis>cm.ulteo.com</emphasis> but you need to set your name in accordance with your own domain name)</para>
      </listitem>
    </itemizedlist>
    <para>
      Both servers need to be installed with <emphasis role="strong">Ubuntu 8.04.1 (Hardy Heron) Server for x86/32 bits</emphasis> (it can be downloaded from <ulink url="http://releases.ubuntu.com/8.04/ubuntu-8.04.1-server-i386.iso" />)
      All operations need to be done as <emphasis>super user</emphasis>.
    </para>

    <itemizedlist>
      <listitem>
	<para>To enable the root account:
	  <screen>
	    <![CDATA[
$ sudo passwd
$ su]]>
	  </screen>
	</para>
      </listitem>
    </itemizedlist>

    <section>
      <title>Installation of MySQL</title>
      <para>
	If you don't have any available MySQL database, you have to install MySQL on your Session Manager.
      </para>
      <itemizedlist>
	<listitem>
	  <para>Install the <emphasis>mysql-server</emphasis> package:</para>
          <screen># apt-get install mysql-server</screen>
          <para>A password for <literal>root</literal> will be asked.</para>
        </listitem>
        <listitem>
          <para>Now log in mysql, create a database and a user that will have
          rights on this databse:</para>
          <screen><![CDATA[
# mysql -u root -p
Enter password: 
mysql> create database ulteo_sm;
 Query OK, 1 row affected (0.05 sec)
mysql> GRANT ALL PRIVILEGES ON ulteo_sm.* TO 'ulteoadmin'@'localhost' IDENTIFIED BY 'secret' WITH GRANT OPTION;
 Query OK, 0 rows affected (0.03 sec)
mysql> quit]]>
          </screen>
        </listitem>
      </itemizedlist>
      <beginpage />
    </section>
  </section>

  <section>
    <title>Session Manager (sm.ulteo.com)</title>
    <para>
      The Session Manager is the main server for your <emphasis>Ulteo Open Virtual Desktop infrastructure</emphasis>.
      It will manage all your application servers through an administration web interface.
    </para>
<!--    <para>
      The Session Manager needs a MySQL database access to run. If you don't have any MySQL database, you can install it on your Session Manager server by reading this <ulink url="mysql.html">documentation</ulink>.
    </para>-->

  <section>
    <title>Installation</title>

    <itemizedlist>
      <listitem>
	<para>
	  Add the Ulteo repository to the repository list:
	</para>
        <screen>
	  <![CDATA[
# echo "deb http://archive.ulteo.com/ulteo/ovd ovd-polaris main" >> /etc/apt/sources.list
# apt-get update]]>
	</screen>
      </listitem>
      <listitem>
	<para>Intall the <emphasis>ulteo-ovd-session-manager</emphasis> package:</para>
        <screen>
	  <![CDATA[
# apt-get install ulteo-ovd-session-manager]]>
	</screen>
      </listitem>

      <listitem>
	<para>
	  The installer asks for an admin login
	</para>
    	<para>
	  <inlinemediaobject>
	    <imageobject>
              <imagedata fileref="img/sm_install_admin_login.png"/>
	    </imageobject>
	    <textobject>
	      <phrase>Session Manager installation admin login</phrase>
	    </textobject>
	  </inlinemediaobject>
	</para>
	<beginpage />
      </listitem>

      <listitem>
	<para>
	  And a password:
	</para>
    	<para>
	  <inlinemediaobject>
	    <imageobject>
              <imagedata fileref="img/sm_install_admin_password.png"/>
	    </imageobject>
	    <textobject>
	      <phrase>Session Manager installation admin password</phrase>
	    </textobject>
	  </inlinemediaobject>
	</para>
      </listitem>

      <listitem>
	<para>
	  which has to be confirmed:
	</para>
    	<para>
	  <inlinemediaobject>
	    <imageobject>
              <imagedata fileref="img/sm_install_admin_confirm_password.png"/>
	    </imageobject>
	    <textobject>
	      <phrase>Session Manager installation admin password confirmation</phrase>
	    </textobject>
	  </inlinemediaobject>
	</para>
	<beginpage />
      </listitem>

      <listitem>
	<para>
	  Application servers are using an application system that will be the same for all your application servers:
	</para>
    	<para>
	  <inlinemediaobject>
	    <imageobject>
              <imagedata fileref="img/sm_install_chroot_location.png"/>
	    </imageobject>
	    <textobject>
	      <phrase>Session Manager installation application system archive</phrase>
	    </textobject>
	  </inlinemediaobject>
	</para>
	<para>
	If you don't have access to Internet, keep this field empty, 
	we'll see later how to install it by hand.
	</para>
      </listitem>
    </itemizedlist>

    <para>
      The server is now installed but not configured yet. You have to open <ulink url="http://sm.ulteo.com/sessionmanager" /> with a web browser.It should display this page:
    </para>
    <para>
      <inlinemediaobject>
	<imageobject>
	  <imagedata fileref="img/sm_www_service_not_available.png"/>
	</imageobject>
	<textobject>
	  <phrase>Session Manager into a web browser</phrase>
	</textobject>
      </inlinemediaobject>
    </para>



    <section>
      <title>Setup the application system archive</title>

      <para>
	If you didn't specify an URL at the last question, you have to copy an application system archive into <emphasis role="strong">/usr/share/ulteo/sessionmanager/base.tar.gz</emphasis>.
      </para>

      <para>
	For instance, you can download an arhive from <ulink url="http://www.ulteo.com/main/downloads/ulteo-ovd.php" /> from another computer which have access to Internet and copy it on a usb stick.
	Then, you have to copy it on the Session Manager at <emphasis>/usr/share/ulteo/sessionmanager/base.tar.gz</emphasis>
      </para>
      <beginpage />
    </section>

  </section>

   <section>
      <title>Configuration</title>

      <para>
	The first step is to go to <ulink url="http://sm.ulteo.com/sessionmanager/admin" /> and autenticate yourself with the login and password you provided during the installation.
      </para>
      <para>
	<inlinemediaobject>
	  <imageobject>
	    <imagedata fileref="img/sm_www_admin_login.png"/>
	  </imageobject>
	  <textobject>
	    <phrase>Session Manager admin login</phrase>
	  </textobject>
	</inlinemediaobject>
      </para>

      <para>
	<inlinemediaobject>
	  <imageobject>
	    <imagedata fileref="img/sm_install_admin_config_init.png"/>
	  </imageobject>
	  <textobject>
	    <phrase>Session Manager admin init configuration</phrase>
	  </textobject>
	</inlinemediaobject>
      </para>

      <itemizedlist>
	<listitem>
	  <para>
	    <emphasis role="strong">Authorized network domain:</emphasis> replace by the domain name of your network.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Disable reverse FQDN checking:</emphasis>
	    if you don't have a valid domain name service for your machines, you have to select <emphasis>yes</emphasis> but it may be a security risk.
	    Ideally, you should configure your DNS server correclty and keep this option to <emphasis>No</emphasis>.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Advanced settings options:</emphasis>
	    You can allow the user to force some options. For instance, to force the application server to want to use, or to enable the debug mode.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis role="strong">MySQL configuration:</emphasis>
	    you have to provide some MySQL configuration data to get the system work.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis role="strong">Module ApplicationDB:</emphasis>
	    select MySQL. The "fake" module is a hard-coded application list used when there are problems with the automatic application detection.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Module UserDB:</emphasis>
	    there are several ways to plug users into the system:
	  </para>
	  <itemizedlist>
	    <listitem>
	      <para>
		<emphasis>fake</emphasis>: it's a hard-coded user list to quickly test the system. 
		For instance, you can begin with this module if you have never tested it earlier.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<emphasis>LDAP</emphasis>: if you are using LDAP to manage your users, you can select this module and configure how to match your users with the directory (LDAP tree, DN ...).
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<emphasis>Active Directory</emphasis>: if you want to plug the system into your Active Directoy server, select this module and provide you AD server name and domain.
	      </para>
	    </listitem>
	  </itemizedlist>
	</listitem>

	<listitem>
	  <para>
	    <emphasis role="strong">Plugin configuration FS</emphasis>:
	    You can choose how to manage the home directory for your users:
	  </para>
	  <itemizedlist>
	    <listitem>
	      <para>
		if you select Active Directory as UserDB, 
		you certainly want to use the Windows share directory from your CIFS servers. In that case, select the CIFS module.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		if your are using NFS servers for your users home dirs and you know how to setup the matching between the local DB and your LDAP configuration, then you can select NFS.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
	      If you don't have any networked filesystem available, select local. It will store files on the application server.
	      </para>
	    </listitem>
	  </itemizedlist>
	</listitem>
      </itemizedlist>

      <para>
	The session manager has no application server plugged yet.
	You now have to install one or more application servers.
      </para>
      <beginpage />
    </section>
  </section>

  <section>
    <title>
      Application Server installation (cm.ulteo.com)
    </title>
    <itemizedlist>
      <listitem>
        <para>
	  Add the Ulteo repositoriy to the Ubuntu repository list:
        </para>
        <screen>
	  <![CDATA[
# echo "deb http://archive.ulteo.com/ulteo/ovd ovd-polaris main" >> /etc/apt/sources.list
# apt-get update]]>
        </screen>
      </listitem>
      <listitem>
        <para>
	  Install the package <emphasis>ulteo-ovd</emphasis>:
        </para>
        <screen>
	  <![CDATA[
# apt-get install ulteo-ovd]]>
	</screen>
      </listitem>

      <listitem>
        <para>
	  The first question is about the FQDN (Fully Qualified Domain Name) hostname of the machine you are using as an application server.
	  This <emphasis>FQDN</emphasis> is used by the session manager server to manage application servers.
	  If the FQDN is not defined well, this application server will never register on the Main server. 
	  Here we are using <emphasis>cm.ulteo.com</emphasis>:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
              <imagedata fileref="img/cm_install_fqdn.png"/>
            </imageobject>
            <textobject>
	      <phrase>debconf FQDN question</phrase>
            </textobject>
	  </inlinemediaobject>
        </para>
	<beginpage />
      </listitem>

      <listitem>
        <para>
	  The next question is about the URL/path where the session manager can be accessed.
	  Provide the URL that was used previously (we use <ulink url="http://sm.ulteo.com/sessionmanager" /> here for the example, but of course, you have to set your own domain name).
	</para>
	<para>
          <inlinemediaobject>
            <imageobject>
              <imagedata fileref="img/cm_install_sm_url.png"/>
            </imageobject>
            <textobject>
              <phrase>debconf session manager base url question</phrase>
            </textobject>
          </inlinemediaobject>
        </para>
      </listitem>
      

 
    </itemizedlist>

    <para>
      The configuration is now done.
      The system is going to donwload and uncompress the application system archive from the Session Manager your registered.
    </para>
    <para>
      Once done, you just have to restart the service:
    </para>
    <screen>
      <![CDATA[
# /etc/init.d/ulteo-ovd restart]]>
    </screen>
    <beginpage />
  </section>


  <section>
    <title>Register the server and perform a "Publication"</title>
    <para>
      An Application server was installed and is now ready. First, we have to register it, and switch from "maintenance" to "production" mode.

    <itemizedlist>
      <listitem>
	<para>
	  You should see your server showing up as "unregistered" in the server page:
	</para>

	<screenshot>
	  <screeninfo>Session Manager - server page</screeninfo>
	  <graphic fileref="img/sm_admin_server_unregistered.png"></graphic>
	</screenshot>
      </listitem>

      <listitem>
	<para>
	  If you want to use this server on your network, 
	  you have to click on <emphasis>register</emphasis>
	  to switch your server to maintenance mode.
	</para>
      </listitem>
      <listitem>
	<para>Now, click on <emphasis>Switch to production</emphasis> to switch it to Production mode.</para>
      </listitem>
    </itemizedlist>
    </para>
    <beginpage />
    <para>
      The next step is to perform a "publication" to authorize a group of users to use a group of applications.
    </para>
    <para>&nbsp;</para>
    <screenshot>
      <screeninfo>Session manager - publication page</screeninfo>
      <graphic fileref="img/sm_admin_publication.png"></graphic>
    </screenshot>
    <para>
      Go to the Publications page, select and follow the <emphasis>wizard</emphasis> steps.
    </para>
    <beginpage />
  </section>


  <section>
    <title>Launch a session</title>

    <itemizedlist>
      <listitem>
	<para>
	  Back to <ulink url="http://sm.ulteo.com/sessionmanager/" /> with your browser, you should see a login page:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
	      <imagedata fileref="img/sm_login.png"/>
            </imageobject>
            <textobject>
	      <phrase>Session Manager login</phrase>
            </textobject>
	  </inlinemediaobject>
	</para>
	<para>&nbsp;</para>
	<beginpage />
      </listitem>


      <listitem>
	<para>
	  Once logged in, the session is launching:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
	      <imagedata fileref="img/cm_session_launching.png"/>
            </imageobject>
            <textobject>
	      <phrase>Session launching</phrase>
            </textobject>
	  </inlinemediaobject>
	</para>
	<beginpage />
      </listitem>

      <listitem>
	<para>
	  The session is launched and is ready to use with applications that have been published for the user:
	</para>
	<para>
	  <inlinemediaobject>
            <imageobject>
	      <imagedata fileref="img/cm_session.png"/>
            </imageobject>
            <textobject>
	      <phrase>Session launched</phrase>
            </textobject>
	  </inlinemediaobject>
	</para>
      </listitem>
    </itemizedlist> 
  </section>
</article>

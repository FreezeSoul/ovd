m4_define([uovdsm_version_major], [1])
m4_define([uovdsm_version_minor], [0])
m4_define([uovdsm_version_build], [~svn@REVISION@])
m4_define([uovdsm_version], [uovdsm_version_major().uovdsm_version_minor()uovdsm_version_build()])

AC_INIT([ovd-session-manager], [uovdsm_version], [http://bugs.ulteo.com])

# Init automake
AM_INIT_AUTOMAKE([tar-pax])

# Checks for programs.
AC_PROG_INSTALL

# Intl (borrowed from intltool.m4)
AC_PATH_PROG(INTLTOOL_UPDATE, [intltool-update])
AC_PATH_PROG(INTLTOOL_MERGE, [intltool-merge])
AC_PATH_PROG(INTLTOOL_EXTRACT, [intltool-extract])
if test -z "$INTLTOOL_UPDATE" -o -z "$INTLTOOL_MERGE" -o -z "$INTLTOOL_EXTRACT"; then
    AC_MSG_ERROR([The intltool scripts were not found. Please install intltool.])
fi

# Check the gettext tools to make sure they are GNU
AC_PATH_PROG(XGETTEXT, xgettext)
AC_PATH_PROG(MSGMERGE, msgmerge)
AC_PATH_PROG(MSGFMT, msgfmt)
if test -z "$XGETTEXT" -o -z "$MSGMERGE" -o -z "$MSGFMT"; then
    AC_MSG_ERROR([GNU gettext tools not found; required for intltool])
fi
xgversion="`$XGETTEXT --version|grep '(GNU ' 2> /dev/null`"
mmversion="`$MSGMERGE --version|grep '(GNU ' 2> /dev/null`"
mfversion="`$MSGFMT --version|grep '(GNU ' 2> /dev/null`"
if test -z "$xgversion" -o -z "$mmversion" -o -z "$mfversion"; then
    AC_MSG_ERROR([GNU gettext tools not found; required for intltool])
fi

AC_PATH_PROG(INTLTOOL_PERL, [perl])
if test -z "$INTLTOOL_PERL"; then
   AC_MSG_ERROR([perl not found; required for intltool])
fi
if test -z "`$INTLTOOL_PERL -v | fgrep '5.' 2> /dev/null`"; then
   AC_MSG_ERROR([perl 5.x required for intltool])
fi
if test "x$2" != "xno-xml"; then
   AC_MSG_CHECKING([for XML::Parser])
   if `$INTLTOOL_PERL -e "require XML::Parser" 2>/dev/null`; then
       AC_MSG_RESULT([ok])
   else
       AC_MSG_ERROR([XML::Parser perl module is required for intltool])
   fi
fi
GETTEXT_PACKAGE=uovdsm
AC_SUBST(GETTEXT_PACKAGE)
ALL_LINGUAS=$(sed -r -e "/^#/d" -e "s/#.*//" "po/LINGUAS")
AC_SUBST(ALL_LINGUAS)

AC_CONFIG_FILES([
Makefile
po/Makefile
config/Makefile
scripts/Makefile
web/Makefile
web/ajax/Makefile
web/webservices/admin/Makefile
web/webservices/Makefile
web/media/image/Makefile
web/media/script/ajax/Makefile
web/media/script/Makefile
web/media/script/lib/nifty/Makefile
web/media/script/lib/prototype/Makefile
web/media/script/lib/scriptaculous/Makefile
web/media/script/lib/Makefile
web/media/style/Makefile
web/media/Makefile
web/plugins/Makefile
web/plugins/FS/Makefile
web/modules/Makefile
web/modules/UserGroupDB/Makefile
web/modules/UserDB/Makefile
web/modules/ApplicationDB/Makefile
web/admin/media/script/ajax/Makefile
web/admin/media/script/Makefile
web/admin/media/style/Makefile
web/admin/media/image/menu/Makefile
web/admin/media/image/Makefile
web/admin/media/Makefile
web/admin/modules/UserDB/Makefile
web/admin/modules/ApplicationDB/Makefile
web/admin/modules/UserGroupDB/Makefile
web/admin/modules/Makefile
web/admin/includes/Makefile
web/admin/classes/Makefile
web/admin/submenu/Makefile
web/admin/Makefile
web/applet/Makefile
web/includes/Makefile
web/classes/Makefile
web/classes/abstract/Makefile
web/classes/abstract/liaison/Makefile
web/classes/events/Makefile
web/classes/tasks/Makefile
web/PEAR/Makefile
web/PEAR/Auth/Makefile
web/PEAR/Auth/SASL/Makefile
web/PEAR/Mail/Makefile
web/PEAR/Net/Makefile
web/events/Makefile
web/events/callbacks/Makefile
web/events/callbacks/SessionStartEvent/Makefile
web/events/callbacks/ServerStatusChanged/Makefile
examples/Makefile
])
AC_OUTPUT
